---
layout: singlepost
title: 模拟微信webview
tags: 微信 前端开发 javascript
category: 实验
---

在某些前端项目开发过程中，我们需要不断在微信中调试和测试我们的页面，这给本地调试造成了很大的不便。 Weixin-WebView-Mock就是解决这个问题的迷你辅助工具，正所谓：

> 专注于小而美，令人心驰神往

具体的项目已经放在Github上了，所以这里不再赘述，放上核心实现代码：

{% highlight javascript linenos %}
/*
 * 模拟微信webview的行为
 * 调试，测试时可以使用
 * 作者：Archer_小A
 */


(function(){

	var __wx = {};

	//call
	__wx.__call = function(m){
        __wx.callMethods[m]();
	}

	//invoke
	__wx.__invoke = function(m, args, callback){
		__wx.invokeMethods[m](args, callback);
	}

	//on
	__wx.__on = function(m, handler){
		__wx.__events[m](handler);
	}

	//invokes
	__wx.invokeMethods = {

		//分享到微博
		"shareWeibo": function(args, callback){
			alert(args["url"]);
		},

		//分享到朋友圈
		"shareTimeline": function(args, callback){
			alert(args["title"]);
		},

		//发送给好友
		"sendAppMessage": function(args, callback){
			alert(args["title"]);
		}

	}

	//接口
	__wx.callMethods = {
		//隐藏右上角按钮
		"hideOptionMenu": function(){
			alert("你调用了隐藏右上角按钮");
		}
	}

	//eventlistener
	__wx.__events = {

		//菜单-分享到微博
		"menu:share:weibo": function(handler){
			handler.apply(this, arguments);
		},

		//菜单-发送给好友
		"menu:share:appmessage": function(handler){
			handler.apply(this, arguments);
		},

		//菜单-分享到朋友圈
		"menu:share:timeline": function(handler){
			handler.apply(this, arguments);
		}

	}


	//暴露给window的WeixinJSBridge
	window.WeixinJSBridge = {
		"call": __wx.__call,
		"invoke": __wx.__invoke,
		"on": __wx.__on
	}

}());

{% endhighlight %}


### in github

[Weixin-WebView-Mock](https://github.com/qddegtya/Weixin-WebView-Mock "Weixin-WebView-Mock")